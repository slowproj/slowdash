<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Data Binding</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="style.css" />
</head>

<body>

<header>
<div class="title">Data Binding</div><p>
<div class="toc">
<span class="toc-title">Contents</span>
<nav id="TOC">
<ul>
<li><a href="#simple-cases" id="toc-simple-cases">Simple Cases</a></li>
<li><a href="#concepts-and-terminologies"
id="toc-concepts-and-terminologies">Concepts and Terminologies</a>
<ul>
<li><a href="#data-model" id="toc-data-model">Data Model</a></li>
<li><a href="#channels-and-data-store-schemata"
id="toc-channels-and-data-store-schemata">Channels and Data-Store
Schemata</a></li>
</ul></li>
<li><a href="#rdbms-sql-database" id="toc-rdbms-sql-database">RDBMS (SQL
Database)</a>
<ul>
<li><a href="#supported-database-systems"
id="toc-supported-database-systems">Supported Database Systems</a></li>
<li><a href="#configuration"
id="toc-configuration">Configuration</a></li>
<li><a href="#time-series-of-scalar-values"
id="toc-time-series-of-scalar-values">Time-Series of Scalar
Values</a></li>
<li><a href="#time-series-of-histograms-graphs-tables-trees"
id="toc-time-series-of-histograms-graphs-tables-trees">Time-Series of
Histograms, Graphs, Tables &amp; Trees</a></li>
<li><a href="#time-series-of-blobs"
id="toc-time-series-of-blobs">Time-Series of Blobs</a></li>
<li><a href="#sql-query-result-as-a-table"
id="toc-sql-query-result-as-a-table">SQL Query Result as a
Table</a></li>
</ul></li>
<li><a href="#influxdb-1" id="toc-influxdb-1">InfluxDB</a>
<ul>
<li><a href="#preparation" id="toc-preparation">Preparation</a></li>
<li><a href="#time-series-of-scalar-values-1"
id="toc-time-series-of-scalar-values-1">Time-Series of Scalar
Values</a></li>
<li><a href="#time-series-of-histograms-graphs-tables-trees-1"
id="toc-time-series-of-histograms-graphs-tables-trees-1">Time-Series of
Histograms, Graphs, Tables &amp; Trees</a></li>
<li><a href="#time-series-of-blobs-1"
id="toc-time-series-of-blobs-1">Time-Series of Blobs</a></li>
</ul></li>
<li><a href="#redis-1" id="toc-redis-1">Redis</a>
<ul>
<li><a href="#preparation-1" id="toc-preparation-1">Preparation</a></li>
<li><a href="#data-binding" id="toc-data-binding">Data Binding</a></li>
<li><a href="#time-series-of-scalar-values-2"
id="toc-time-series-of-scalar-values-2">Time-Series of Scalar
Values</a></li>
<li><a href="#time-series-of-histograms-graphs-tables-trees-2"
id="toc-time-series-of-histograms-graphs-tables-trees-2">Time-Series of
Histograms, Graphs, Tables &amp; Trees</a></li>
<li><a href="#time-series-of-blobs-2"
id="toc-time-series-of-blobs-2">Time-series of Blobs</a></li>
<li><a href="#hash-as-a-tree" id="toc-hash-as-a-tree">Hash as a
Tree</a></li>
<li><a href="#current-histograms-graphs-tables-trees"
id="toc-current-histograms-graphs-tables-trees">“Current” Histograms,
Graphs, Tables &amp; Trees</a></li>
</ul></li>
<li><a href="#mongodb" id="toc-mongodb">MongoDB</a>
<ul>
<li><a href="#preparation-2" id="toc-preparation-2">Preparation</a></li>
<li><a href="#time-series-of-scalars"
id="toc-time-series-of-scalars">Time-Series of Scalars</a></li>
<li><a href="#time-series-of-histograms-graphs-tables-trees-3"
id="toc-time-series-of-histograms-graphs-tables-trees-3">Time-Series of
Histograms, Graphs, Tables &amp; Trees</a></li>
<li><a href="#time-series-of-blobs-3"
id="toc-time-series-of-blobs-3">Time-Series of Blobs</a></li>
</ul></li>
<li><a href="#couchdb" id="toc-couchdb">CouchDB</a>
<ul>
<li><a href="#preparation-3" id="toc-preparation-3">Preparation</a></li>
<li><a href="#schema" id="toc-schema">Schema</a></li>
<li><a href="#time-series-of-scalars-1"
id="toc-time-series-of-scalars-1">Time-Series of Scalars</a></li>
<li><a href="#time-series-of-histograms-graphs-tables-trees-4"
id="toc-time-series-of-histograms-graphs-tables-trees-4">Time-Series of
Histograms, Graphs, Tables &amp; Trees</a></li>
<li><a href="#time-series-of-blobs-4"
id="toc-time-series-of-blobs-4">Time-Series of Blobs</a></li>
<li><a href="#view-rows-as-a-table"
id="toc-view-rows-as-a-table">View-Rows as a Table</a></li>
<li><a href="#view-row-as-a-tree" id="toc-view-row-as-a-tree">View-Row
as a Tree</a></li>
<li><a href="#database-information-as-a-tree"
id="toc-database-information-as-a-tree">Database information as a
Tree</a></li>
</ul></li>
<li><a href="#local-csv-files" id="toc-local-csv-files">Local CSV
Files</a>
<ul>
<li><a href="#time-series-of-scalar-values-3"
id="toc-time-series-of-scalar-values-3">Time-Series of Scalar
Values</a></li>
<li><a href="#time-series-of-histograms-graphs-tables-trees-5"
id="toc-time-series-of-histograms-graphs-tables-trees-5">Time-Series of
Histograms, Graphs, Tables &amp; Trees</a></li>
<li><a href="#current-histograms-graphs-tables-trees-1"
id="toc-current-histograms-graphs-tables-trees-1">“Current” Histograms,
Graphs, Tables &amp; Trees</a></li>
</ul></li>
<li><a href="#local-yaml-files" id="toc-local-yaml-files">Local YAML
Files</a></li>
<li><a href="#local-root-files" id="toc-local-root-files">Local ROOT
Files</a></li>
</ul>
</nav>
</div>
</header>

<h1 id="simple-cases">Simple Cases</h1>
<h3 id="sql-db">SQL DB</h3>
<p>If the time-series data is stored in a table <code>data_table</code>
with the contents like this (“long format”):</p>
<table>
<thead>
<tr class="header">
<th>channel</th>
<th>timestamp</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sccm.Alicat.Inj.Gas</td>
<td>2022-09-15 03:19:25.496212+00</td>
<td>0</td>
</tr>
<tr class="even">
<td>V.ThermoCo.Diss.AS</td>
<td>2022-09-15 03:19:27.612427+00</td>
<td>6.605405e-05</td>
</tr>
<tr class="odd">
<td>mbar.IG.Vac.AS</td>
<td>2022-09-15 03:19:31.490579+00</td>
<td>2.26e-07</td>
</tr>
<tr class="even">
<td>mbar.IG.Vac.MS</td>
<td>2022-09-15 03:19:31.529545+00</td>
<td>2e-09</td>
</tr>
<tr class="odd">
<td>mbar.IG.Vac.BS</td>
<td>2022-09-15 03:19:31.610188+00</td>
<td>4e-09</td>
</tr>
</tbody>
</table>
<p>Then the <code>data source</code> part of the configuration looks
like:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> postgresql://USER:PASS@localhost:5432/DBNAME</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> data_table[channel]@timestamp=value</span></span></code></pre></div>
<p>Change <code>PostgreSQL</code> to <code>MySQL</code> or
<code>SQLite</code> for other SQL DB systems.</p>
<h3 id="influxdb">InfluxDB</h3>
<p>If only one tag is used for the channel names and one field for data
values (<code>MEAS,channel=CH1 value=VAL1 TIME</code>):</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> influxdb://ORGANIZATION@localhost:8086/BUCKET/MEASUREMENT</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">token</span><span class="kw">:</span><span class="at"> TOKEN</span></span></code></pre></div>
<h3 id="redis">Redis</h3>
<p>All the time-series entries will be taken from a database:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> redis://localhost:6739/1</span></span></code></pre></div>
<h1 id="concepts-and-terminologies">Concepts and Terminologies</h1>
<h2 id="data-model">Data Model</h2>
<h3 id="time-series-data">Time-Series Data</h3>
<ul>
<li>All data used by SlowDash is time-series
<ul>
<li>Data can be a time-series of scalars</li>
<li>Data can be a time-series of histograms, graphs, tables, or trees
<p></li>
</ul></li>
<li>For data not explicitly bound for time-stamps, the time-series data
can contain a single element with a time-stamp of “neutral” or
“current”.
<ul>
<li>The “neutral” timestamp matches with any data request time
intervals.</li>
<li>The “current” timestamp matches only if the data request includes
the current time.</li>
<li>Therefore data storages can contain data without time-stamps.
Examples are:
<ul>
<li>CSV file as a table</li>
<li>ROOT files containing histograms and graphs</li>
<li>JSON / YAML file containing parameters as a tree object</li>
<li>Instant readout values (“current”)
<p></li>
</ul></li>
</ul></li>
<li>Even if a table contains time-stamped rows, the table itself is a
data block without explicit time-stamps.
<ul>
<li>Examples:
<ul>
<li>log file (table)</li>
<li>run table</li>
<li>CSV file with time-stamps in the first column</li>
</ul></li>
<li>The contents can be converted to a time-series. Until that, the data
block is a single data object.
<p></li>
</ul></li>
<li>[TODO] <code>valid_from</code> attribute in data source description:
either a timestamp/datetime, <code>now</code> (“current”), or
<code>creation</code>. The default is timestamp <code>0</code>, meaning
“neutral”.</li>
<li>[TODO] a set of data elements with different <code>valid_from</code>
should allow picking up the “newest” for a given time.
<p></li>
<li>[TODO] <code>aggregation</code> parameter in data query: either
<code>none</code> (default for time-series of scalars),
<code>last</code> (default for time-series of objects), or
<code>sum</code> (cumulative histogram / merged graph / appended
table).</li>
</ul>
<h3 id="time-representation">Time Representation</h3>
<ul>
<li>Time-stamps are one of:
<ul>
<li>UNIX timestamp, the number of seconds since the UNIX epoch</li>
<li>ISO date time string, with explicit time-zone</li>
<li>ISO date time string, without explicit time-zone (not recommended)
<ul>
<li>SlowDash configuration file can specify the time-zone of the
data.</li>
<li>Even if the used time-zone is UTC, it should be specified
explicitly.</li>
<li>Otherwise the time-zone of the data server is used for most cases,
but not guaranteed (not recommended)</li>
</ul></li>
</ul></li>
</ul>
<h3 id="data-indexing-channels">Data Indexing (Channels)</h3>
<ul>
<li>Each time-series has an unique name, “channel”.</li>
<li>Single data element can be uniquely identified by a pair of
“channel” and “time-stamp”.</li>
<li>A data element can be a numerical scalar value (typical), a scalar
value of boolean or string, or an object such as a histogram, graph,
table, tree, or blob (image etc).</li>
<li>[TODO] Using an array (vector of scalars) as a data element is under
consideration. A table can be always used for an array.
<p></li>
<li>In a data table, if channel names are stored as a value of a column
(case 1 below), this is called a “tag”.</li>
<li>In a data table, column(s) that contain(s) data values is/are called
“field”(s).
<p></li>
<li>Depending on the structure of the data table, “channel” can be a
“tag” (case 1), “field” (case 2), or combination of them (case 3).
<p></li>
<li>Depending on the structure of the data table, there might exist
multiple tags (case 4); the additional tag(s) is/are called (a)
“flag”(s).</li>
</ul>
<h3 id="schema-descriptor">Schema Descriptor</h3>
<p>For a table storing time-series data, a “schema descriptor” describes
which columns are for timestamps, tas(s) and field(s).</p>
<h4 id="examples">Examples</h4>
<ul>
<li><code>data_table[endpoint_name]@timestamp=value</code></li>
<li><code>data_table[endpoint_name,set_or_ist]@timestamp(unix)=value_raw,value_cal</code></li>
<li><code>data_table[endpoint_name]@datetime(with timezome)=value_raw(default),value_cal</code></li>
</ul>
<p>
<h4 id="syntax">Syntax</h4>
<ul>
<li>The first word is the table name.</li>
<li>Tag names, if exist, come next. Multiple tags are separated by
<code>,</code>.</li>
<li>Timestamp column name follows a prefix of <code>@</code>.</li>
<li>After an <code>=</code>, field column names are listed.
<p></li>
<li>If the timestamp column is inferrable, it can be omitted.</li>
<li>Timestamp may have a type specifier in <code>()</code>. Type
specifier is case insensitive.</li>
<li>Empty field list implies that all the columns other than the
timestamp and tags are fields.
<p></li>
<li>All spaces are skipped.</li>
<li>If a column name includes a special character, the entire name must
be quoted with <code>"</code>.</li>
</ul>
<h3 id="restrictions">Restrictions</h3>
<ul>
<li>For security reasons, for SQL databases, SlowDash accepts for column
names only alphabets, digits, and tightly selected special characters
such as <code>_</code>, <code>-</code>, <code>.</code>, and
<code>:</code>.</li>
<li>Therefore, a channel name like <code>';drop table datatable</code>
is not allowed, and will be rejected, even though proper handling is
technically possible.</li>
</ul>
<h2 id="channels-and-data-store-schemata">Channels and Data-Store
Schemata</h2>
<p>Note that the numeric data values shown here can be of any other
scalar types (string etc.) or objects (histogram etc.).</p>
<h3 id="case-1-tag-values-for-channel">Case 1: Tag Values for
Channel</h3>
<table>
<thead>
<tr class="header">
<th>metric</th>
<th>timestamp</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>psia.Alicat.Inj.Gas</td>
<td>2022-09-15 03:19:25.419417+00</td>
<td>9.6</td>
</tr>
<tr class="even">
<td>degC.Alicat.Inj.Gas</td>
<td>2022-09-15 03:19:25.458695+00</td>
<td>23.42</td>
</tr>
<tr class="odd">
<td>sccm.Alicat.Inj.Gas</td>
<td>2022-09-15 03:19:25.496212+00</td>
<td>0</td>
</tr>
<tr class="even">
<td>V.ThermoCo.Diss.AS</td>
<td>2022-09-15 03:19:27.612427+00</td>
<td>6.605405e-05</td>
</tr>
<tr class="odd">
<td>V.PS.Diss.AS</td>
<td>2022-09-15 03:19:29.387352+00</td>
<td>0.01</td>
</tr>
<tr class="even">
<td>A.PS.Diss.AS</td>
<td>2022-09-15 03:19:29.416561+00</td>
<td>0</td>
</tr>
<tr class="odd">
<td>mbar.IG.Vac.AS</td>
<td>2022-09-15 03:19:31.490579+00</td>
<td>2.26e-07</td>
</tr>
<tr class="even">
<td>mbar.IG.Vac.MS</td>
<td>2022-09-15 03:19:31.529545+00</td>
<td>2e-09</td>
</tr>
<tr class="odd">
<td>mbar.IG.Vac.VSS</td>
<td>2022-09-15 03:19:31.56965+00</td>
<td>1.3e-08</td>
</tr>
<tr class="even">
<td>mbar.IG.Vac.BS</td>
<td>2022-09-15 03:19:31.610188+00</td>
<td>4e-09</td>
</tr>
</tbody>
</table>
<ul>
<li>Tag: <code>metric</code></li>
<li>Field: <code>value</code>
<p></li>
<li>Channel name example: <code>psia.Alicat.Inj.Gas</code>
<p></li>
<li>Schema Descriptor examples:
<ul>
<li><code>table[metric]@timestamp(with timezone)=value_raw</code></li>
<li><code>table[endpoint]@timestamp(unix)</code></li>
</ul></li>
</ul>
<h3 id="case-2-field-names-for-channel">Case 2: Field Names for
Channel</h3>
<table style="width:100%;">
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="header">
<th>RunNumber</th>
<th>TimeStamp</th>
<th>sccm.Alicat.Inj</th>
<th>mbar.CC10.Inj</th>
<th>K.ThrmCpl.Diss</th>
<th>mbar.IG.AS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3098</td>
<td>1664916014</td>
<td>3</td>
<td>1.18467</td>
<td>340.58</td>
<td>5.38333e-05</td>
</tr>
<tr class="even">
<td>3097</td>
<td>1664915456</td>
<td>3</td>
<td>1.256</td>
<td>503.275</td>
<td>5.36e-05</td>
</tr>
<tr class="odd">
<td>3096</td>
<td>1664914833</td>
<td>3</td>
<td>1.36833</td>
<td>745.743</td>
<td>5.38333e-05</td>
</tr>
<tr class="even">
<td>3095</td>
<td>1664913608</td>
<td>3</td>
<td>1.447</td>
<td>1154.09</td>
<td>5.44e-05</td>
</tr>
<tr class="odd">
<td>3094</td>
<td>1664913032</td>
<td>3</td>
<td>1.48933</td>
<td>1501.14</td>
<td>5.46667e-05</td>
</tr>
<tr class="even">
<td>3093</td>
<td>1664912407</td>
<td>3</td>
<td>1.533</td>
<td>1799.61</td>
<td>5.52667e-05</td>
</tr>
<tr class="odd">
<td>3092</td>
<td>1664911835</td>
<td>3</td>
<td>1.576</td>
<td>2060.59</td>
<td>5.56e-05</td>
</tr>
<tr class="even">
<td>3091</td>
<td>1664910949</td>
<td>0.1</td>
<td>0.163633</td>
<td>2069.99</td>
<td>3.82667e-06</td>
</tr>
<tr class="odd">
<td>3090</td>
<td>1664910320</td>
<td>0.1</td>
<td>0.163533</td>
<td>1820.41</td>
<td>2.72333e-06</td>
</tr>
<tr class="even">
<td>3089</td>
<td>1664909732</td>
<td>0.1</td>
<td>0.163533</td>
<td>1521.82</td>
<td>2.54e-06</td>
</tr>
</tbody>
</table>
<ul>
<li>Tag: none</li>
<li>Fields: everything other than <code>TimeStamp</code>
<p></li>
<li>Channel name example: <code>sccm.Alicat.Inj</code>
<p></li>
<li>Schema Descriptor examples:
<ul>
<li><code>RunTable@TimeStamp(unix)=sccm.Alicat.Inj,mbar.CC10.Inj,K.THrmCpl.Diss,mbar.IG.AS</code></li>
<li><code>RunTable@TimeStamp(unix)</code></li>
</ul></li>
</ul>
<h3 id="case-3-tag-values-and-field-names-for-channel">Case 3: Tag
Values and Field Names for Channel</h3>
<table>
<colgroup>
<col style="width: 26%" />
<col style="width: 38%" />
<col style="width: 17%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="header">
<th>metric</th>
<th>timestamp</th>
<th>value_raw</th>
<th>value_cal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>psia.Alicat.Inj.Gas</td>
<td>2022-09-15 03:19:25.419417+00</td>
<td>9.6</td>
<td>9.6</td>
</tr>
<tr class="even">
<td>degC.Alicat.Inj.Gas</td>
<td>2022-09-15 03:19:25.458695+00</td>
<td>23.42</td>
<td>23.42</td>
</tr>
<tr class="odd">
<td>sccm.Alicat.Inj.Gas</td>
<td>2022-09-15 03:19:25.496212+00</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>V.ThermoCo.Diss.AS</td>
<td>2022-09-15 03:19:27.612427+00</td>
<td>6.605405e-05</td>
<td>6.605405e-05</td>
</tr>
<tr class="odd">
<td>V.PS.Diss.AS</td>
<td>2022-09-15 03:19:29.387352+00</td>
<td>0.01</td>
<td>0.01</td>
</tr>
<tr class="even">
<td>A.PS.Diss.AS</td>
<td>2022-09-15 03:19:29.416561+00</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>mbar.IG.Vac.AS</td>
<td>2022-09-15 03:19:31.490579+00</td>
<td>2.26e-07</td>
<td>2.26e-07</td>
</tr>
<tr class="even">
<td>mbar.IG.Vac.MS</td>
<td>2022-09-15 03:19:31.529545+00</td>
<td>2e-09</td>
<td>2e-09</td>
</tr>
<tr class="odd">
<td>mbar.IG.Vac.VSS</td>
<td>2022-09-15 03:19:31.56965+00</td>
<td>1.3e-08</td>
<td>1.3e-08</td>
</tr>
<tr class="even">
<td>mbar.IG.Vac.BS</td>
<td>2022-09-15 03:19:31.610188+00</td>
<td>4e-09</td>
<td>4e-09</td>
</tr>
</tbody>
</table>
<ul>
<li>Tag: <code>metric</code></li>
<li>Fields: <code>value_raw</code>, <code>value_cal</code>
<p></li>
<li>Channel name example: <code>sccm.Alicat.Inj:value_cal</code>
<p></li>
<li>Schema Descriptor examples:
<ul>
<li><code>table[metric]@timestamp(with timezone)=value_raw,value_cal</code></li>
<li><code>table[metric]@timestamp(with timezone)=value_raw(default),value_cal</code></li>
<li><code>table[metric]@timestamp(with timezone)</code></li>
</ul></li>
</ul>
<h3 id="case-4-multiple-tags-tag-flags-and-fields">Case 4: Multiple Tags
(Tag + Flag(s)) and Fields</h3>
<table>
<colgroup>
<col style="width: 22%" />
<col style="width: 13%" />
<col style="width: 33%" />
<col style="width: 15%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="header">
<th>metric</th>
<th>set_or_ist</th>
<th>timestamp</th>
<th>value_raw</th>
<th>value_cal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>psia.Alicat.Inj.Gas</td>
<td>ist</td>
<td>2022-09-15 03:19:25.419417+00</td>
<td>9.6</td>
<td>9.6</td>
</tr>
<tr class="even">
<td>degC.Alicat.Inj.Gas</td>
<td>ist</td>
<td>2022-09-15 03:19:25.458695+00</td>
<td>23.42</td>
<td>23.42</td>
</tr>
<tr class="odd">
<td>sccm.Alicat.Inj.Gas</td>
<td>ist</td>
<td>2022-09-15 03:19:25.496212+00</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>V.ThermoCo.Diss.AS</td>
<td>ist</td>
<td>2022-09-15 03:19:27.612427+00</td>
<td>6.605405e-05</td>
<td>6.605405e-05</td>
</tr>
<tr class="odd">
<td>V.PS.Diss.AS</td>
<td>ist</td>
<td>2022-09-15 03:19:29.387352+00</td>
<td>0.01</td>
<td>0.01</td>
</tr>
<tr class="even">
<td>A.PS.Diss.AS</td>
<td>ist</td>
<td>2022-09-15 03:19:29.416561+00</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>mbar.IG.Vac.AS</td>
<td>ist</td>
<td>2022-09-15 03:19:31.490579+00</td>
<td>2.26e-07</td>
<td>2.26e-07</td>
</tr>
<tr class="even">
<td>mbar.IG.Vac.MS</td>
<td>ist</td>
<td>2022-09-15 03:19:31.529545+00</td>
<td>2e-09</td>
<td>2e-09</td>
</tr>
<tr class="odd">
<td>mbar.IG.Vac.VSS</td>
<td>ist</td>
<td>2022-09-15 03:19:31.56965+00</td>
<td>1.3e-08</td>
<td>1.3e-08</td>
</tr>
<tr class="even">
<td>mbar.IG.Vac.BS</td>
<td>ist</td>
<td>2022-09-15 03:19:31.610188+00</td>
<td>4e-09</td>
<td>4e-09</td>
</tr>
</tbody>
</table>
<ul>
<li>Tag: <code>metric</code></li>
<li>Flag(s) <code>set_or_ist</code></li>
<li>Fields: <code>value_raw</code>, <code>value_cal</code>
<p></li>
<li>Channel name example: <code>sccm.Alicat.Inj:value_cal:ist</code>
<p></li>
<li>Schema Descriptor example:
<code>table[metric,set_or_ist]@timestamp(with timezone)=value_raw,value_cal</code></li>
</ul>
<h1 id="rdbms-sql-database">RDBMS (SQL Database)</h1>
<h2 id="supported-database-systems">Supported Database Systems</h2>
<table style="width:100%;">
<colgroup>
<col style="width: 31%" />
<col style="width: 22%" />
<col style="width: 10%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="header">
<th>DBMS</th>
<th>Python Module</th>
<th>Async</th>
<th>Server-side <br>down sampling</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PostgreSQL</td>
<td>psycopg2</td>
<td>no</td>
<td>yes</td>
</tr>
<tr class="even">
<td>PostgreSQL (Async access)</td>
<td>asyncpg</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="odd">
<td>MySQL</td>
<td>mysql-connector-python</td>
<td>no</td>
<td>yes</td>
</tr>
<tr class="even">
<td>MySQL (Async access)</td>
<td>aiomysql</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="odd">
<td>SQLite</td>
<td>(none)</td>
<td>no</td>
<td>no</td>
</tr>
<tr class="even">
<td>Others (generic)</td>
<td>sqlalchemy</td>
<td>no</td>
<td>no</td>
</tr>
</tbody>
</table>
<h2 id="configuration">Configuration</h2>
<h4 id="postgresql">PostgreSQL</h4>
<p>Write SlowDash project configuration file
(<code>SlowdashProject.yaml</code>) like below.</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> postgresql://USER:PASS@HOST:PORT/DB</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> TABLE [ TAG_COLUMN ] @ TIME_COLUMN</span></span></code></pre></div>
<h4 id="mysql">MySQL</h4>
<p>Write SlowDash project configuration file
(<code>SlowdashProject.yaml</code>) like below.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> mysql://USER:PASS@HOST:PORT/DB</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> TABLE [ TAG_COLUMN ] @ TIME_COLUMN</span></span></code></pre></div>
<h4 id="sqlite">SQLite</h4>
<p>Write SlowDash project configuration file
(<code>SlowdashProject.yaml</code>) like below. The SQLite DB file path
is relative to the project directory.</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> sqlite:///FILENAME</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> TABLE [ TAG_COLUMN ] @ TIME_COLUMN</span></span></code></pre></div>
<h4 id="other-sql-dbms">Other SQL DBMS</h4>
<ul>
<li>The “SQLAlchemy” library might support the SQL DB that you are
using. See the <a href="https://www.sqlalchemy.org/">SQLAlchemy
page</a>.</li>
<li>In addition to <code>sqlalchemy</code>, also install the Python
package to access the DB, as described in the SQLAlchemy page.</li>
</ul>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> SQLAlchemy</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> DBTYPE://USER:PASS@HOST:PORT/DB</span></span></code></pre></div>
<h3 id="avoiding-channel-scanning-overhead">Avoiding Channel Scanning
Overhead</h3>
<p>In order to obtain a list of channels, SlowDash makes a query like
<code>SELECT DISTINCT tag FROM table</code>, which can be slow if the
table is large. This can be avoided either by manually listing the
channels or providing an efficient SQL statement:</p>
<h4 id="by-a-manual-list">By a manual list</h4>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> numeric_data[endpoint]@timestamp(with timezone)=value_raw</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">tags</span><span class="kw">:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">           </span><span class="fu">list</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="st">&quot;Ch0&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;Ch1&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;Ch2&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;Ch3&quot;</span><span class="at"> </span><span class="kw">]</span></span></code></pre></div>
<h4 id="by-a-sql-query">By a SQL query</h4>
<p>If the database has a channel table, separately from the data
table:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> numeric_data[endpoint]@timestamp(with timezone)=value_raw</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">tags</span><span class="kw">:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">           </span><span class="fu">sql</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;select name from endpoint_table&quot;</span></span></code></pre></div>
<h3 id="time-stamp-considerations">Time-stamp Considerations</h3>
<p>SlowDash can handle several different data time-stamp types:</p>
<ul>
<li>UNIX timestamp (<code>unix</code>): number of seconds since the UNIX
epoch, always safe</li>
<li>DateTime type with time-zone (<code>aware</code> or
<code>with time zone</code>): maybe useful</li>
<li>DateTime type without time-zone (<code>naive</code> or
<code>without time zone</code>): strongly discouraged</li>
<li>DateTime type in UTC (<code>unspecified utc</code>): sometimes
necessary</li>
</ul>
<h4 id="postgresql-1">PostgreSQL</h4>
<p>PostgreSQL supports several different time types:</p>
<ul>
<li>UNIX timestamp: as <code>INTERGER</code>/<code>BIGINT</code> (32/64
bit), or <code>REAL</code>/<code>DOUBLE PRECISION</code> (32/64
bit)</li>
<li>DateTime with time-zone: <code>TIMESTAMP WITH TIME ZONE</code> /
<code>TIMESTAMPTZ</code></li>
<li>DateTime without time-zone (DISCOURAGED):
<code>TIMESTAMP</code></li>
</ul>
<p><code>TIMESTAMP WITH TIME ZONE</code> is recommended for use with
SlowDash.</p>
<h4 id="mysql-1">MySQL</h4>
<p>MySQL supports several different time types:</p>
<ul>
<li>UNIX timestamp: as <code>INTERGER</code>/<code>BIGINT</code> (32/64
bit) or <code>FLOAT</code>/<code>REAL</code>/<code>DOUBLE</code>
(32/64/64 bit)</li>
<li>DateTime without time-zone (DISCOURAGED): <code>DATETIME</code></li>
<li>DateTime in UTC: <code>TIMESTAMP</code></li>
</ul>
<p>The MySQL libraries used in SlowDash (aiomysql) cannot handle
time-zone with the TIMESTAMP type, therefore if the
<code>TIMESTAMP</code> type is used, it must be specified in SlowDash
configuration file as <code>unspeficied utc</code>. Using the UNIX
timestamps is always safe.</p>
<p>UNIX timestamps as <code>REAL</code> is recommended for use with
SlowDash.</p>
<h4 id="sqlite-1">SQLite</h4>
<p>SQLite does not have dedicated date-time type, and time information
can be stored in time-string as TEXT or UNIX timestamps as INTEGER/REAL.
If a field is declared as <code>DATETIME</code>, it uses TEXT for time
string in UTC.</p>
<ul>
<li>UNIX timestamp: as <code>INTERGER</code> (64 bit) or
<code>REAL</code> (64 bit)</li>
<li>DateTime string in UTC: <code>DATETIME</code></li>
</ul>
<p>If the time string in TEXT (or <code>DATETIME</code>) is used, it
must be specified in SlowDash configuration file as
<code>unspeficied utc</code>. Using the UNIX timestamps is always
safe.</p>
<p>UNIX timestamps as <code>REAL</code> is recommended for use with
SlowDash.</p>
<h2 id="time-series-of-scalar-values">Time-Series of Scalar Values</h2>
<p>To access a table containing time-series data, write the schema in
the <code>time_series</code> entry:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> postgresql://p8_db_user:****@localhost:5432/p8_sc_db</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> numeric_data[endpoint]@timestamp(with timezone)=value_raw</span></span></code></pre></div>
<h4 id="case-1-tag-values-for-channel-1">Case 1: Tag Values for
Channel</h4>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> numeric_data[endpoint]@timestamp(with timezone)=value_raw</span></span></code></pre></div>
<h4 id="case-2-fields-for-channel">Case 2: Fields for Channel</h4>
<div class="sourceCode" id="cb12"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> numeric_data@timestamp(with timezone)=value_raw,value_cal</span></span></code></pre></div>
<h4 id="case-3-tag-and-fields-for-channel">Case 3: Tag and Fields for
Channel</h4>
<div class="sourceCode" id="cb13"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> numeric_data[endpoint]@timestamp(with timezone)=value_raw(default),value_cal</span></span></code></pre></div>
<h4 id="case-4-tag-flags-and-fields-for-channel">Case 4: Tag, Flags and
Fields for Channel</h4>
<p>[TODO] Flags are currently not supported. To use the case 4 schemata,
use the <code>where</code> and <code>suffix</code> options.</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> numeric_data[endpoint]@timestamp(with timezone)=value_raw(default),value_cal</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">where</span><span class="kw">:</span><span class="at"> ist_or_set=&#39;ist&#39;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">suffix</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;:ist&#39;</span></span></code></pre></div>
<h2 id="time-series-of-histograms-graphs-tables-trees">Time-Series of
Histograms, Graphs, Tables &amp; Trees</h2>
<ul>
<li>store JSON string as data value</li>
<li>use <code>object_time_series</code> entry</li>
</ul>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> postgresql://p8_db_user:****@localhost:5432/p8_sc_db</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">object_time_series</span><span class="kw">:</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> histograms[channel]@timestamp(unix)=json</span></span></code></pre></div>
<h2 id="time-series-of-blobs">Time-Series of Blobs</h2>
<p>[TODO] DB system specific?</p>
<h2 id="sql-query-result-as-a-table">SQL Query Result as a Table</h2>
<div class="sourceCode" id="cb16"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> sqlite:///RunTable.db</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">view</span><span class="kw">:</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> RunTable</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">sql</span><span class="kw">:</span><span class="at"> select * from RunTable where TimeStamp &gt;= ${FROM_UNIXTIME} and TimeStamp &lt; ${TO_UNIXTIME}</span></span></code></pre></div>
<ul>
<li>The channel “RunTable” will return a single table object with
time-stamp of “current”.
<p></li>
<li>Currently available variable substitutions are:
<ul>
<li><code>${FROM_UNIXTIME}</code>, <code>${TO_UNIXTIME}</code></li>
<li><code>${FROM_DATETIME}</code>, <code>${TO_DATETIME}</code></li>
<li><code>${FROM_DATETIME_NAIVE}</code>,
<code>${TO_DATETIME_NAIVE}</code></li>
<li><code>${FROM_DATETIME_UTC}</code>,
<code>${TO_DATETIME_UTC}</code></li>
</ul></li>
</ul>
<h1 id="influxdb-1">InfluxDB</h1>
<h2 id="preparation">Preparation</h2>
<ul>
<li>Install Python3 module “influxdb-client”</li>
</ul>
<h2 id="time-series-of-scalar-values-1">Time-Series of Scalar
Values</h2>
<p>For simple cases, just specify the Measurement name in the
<code>time_series</code> entry:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> influxdb://SlowDash@localhost:8086/TestData</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">token</span><span class="kw">:</span><span class="at"> MY_TOKEN_HERE</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">measurement</span><span class="kw">:</span><span class="at"> TestTimeSeries</span></span></code></pre></div>
<p>or in a short form:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> influxdb://SlowDash@localhost:8086/TestData/TestTimeSeries</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">token</span><span class="kw">:</span><span class="at"> MY_TOKEN_HERE</span></span></code></pre></div>
<h4
id="case-1-tag-values-for-channel-measchannelch1-valueval1-time">Case 1:
Tag Values for Channel
(<code>meas,channel=CH1 value=VAL1 TIME</code>)</h4>
<p>If there is only one Tag for channels and one Field for data values,
the simle configuration above works. For data containing multiple tags
and/or fields, specify the names using <code>schema</code>:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> meas[channel]=value</span></span></code></pre></div>
<h4 id="case-2-fields-for-channel-meas-ch1val1ch2val2-time">Case 2:
Fields for Channel (<code>meas ch1=VAL1,ch2=VAL2 TIME</code>)</h4>
<p>If the data does not have any Tag and all the Fields are used, the
simle configuration above works. For data containing multiple tags
and/or fields, specify the names using <code>schema</code>:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> meas=ch1,ch2</span></span></code></pre></div>
<h4
id="case-3-tag-and-fields-for-channel-measchannelch1-value_rawvalrawvalue_calvalcal-time">Case
3: Tag and Fields for Channel
(<code>meas,channel=CH1 value_raw=VALRAW,value_cal=VALCAL TIME</code>)</h4>
<p>Use <code>schema</code> to describe which tag and fields are
used:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> meas[channel]=value_raw(default),value_cal</span></span></code></pre></div>
<h2 id="time-series-of-histograms-graphs-tables-trees-1">Time-Series of
Histograms, Graphs, Tables &amp; Trees</h2>
<ul>
<li>store JSON string as data value</li>
<li>use <code>object_time_series</code> entry</li>
</ul>
<div class="sourceCode" id="cb22"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> influxdb://SlowDash@localhost:8086/TestData</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">token</span><span class="kw">:</span><span class="at"> MY_TOKEN_HERE</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">object_time_series</span><span class="kw">:</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">measurement</span><span class="kw">:</span><span class="at"> TestTimeSeriesOfObjects</span></span></code></pre></div>
<ul>
<li>In InfluxDB, time-series of scalars and time-series of objects
cannot live together in a same “measurement”. Use a dedicated
measurement name for a time-series of objects.</li>
<li>InfluxDB has a limitation on the length of the object stored as a
string: this must be less than 64 kB (as of InfluxDB version 2.6)</li>
</ul>
<h2 id="time-series-of-blobs-1">Time-Series of Blobs</h2>
<ul>
<li>[TODO] store blob as a byte array</li>
</ul>
<h1 id="redis-1">Redis</h1>
<h2 id="preparation-1">Preparation</h2>
<ul>
<li><code>pip3 install redis</code></li>
</ul>
<h2 id="data-binding">Data Binding</h2>
<ul>
<li>RedisTS data can be accessed as a time-series data.</li>
<li>Hash values in simple key-value stores can be accessed as “current”
tree data.</li>
<li>JSON values of objects (histograms etc.) in simple key-value stores
can be accessed as “current” object data.</li>
<li>RedisTS time-series and simple key-value of hash or JSON are
automatically scanned by default.
<p></li>
<li>With a certain convention described below, time-series of objects
can be constructed.</li>
</ul>
<h2 id="time-series-of-scalar-values-2">Time-Series of Scalar
Values</h2>
<ul>
<li>Use RedisTS for time-series</li>
<li>Redis key becomes the channel name</li>
</ul>
<div class="sourceCode" id="cb23"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> redis://localhost:6379</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">time_series</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">db</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<p>or in a short form:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> redis://localhost:6379/1</span></span></code></pre></div>
<h2 id="time-series-of-histograms-graphs-tables-trees-2">Time-Series of
Histograms, Graphs, Tables &amp; Trees</h2>
<h3 id="implementation">Implementation</h3>
<ul>
<li>Time-Series of objects (histograms, graphs, tables and trees) are
implemented by combination of RedisTS and RedisJSON.</li>
<li>Each object makes one RedisJSON entry, with a dedicated key.</li>
<li>RedisTS holds a series of object keys.</li>
<li>Keys are formatted as <code>{Channel}_{Index}</code>, unless
specified in user configuration.</li>
<li>Time-Series of objects are stored in a dedicated ‘db’.</li>
<li>To implement a ring buffer, <code>Index</code> is typically
calculated by <code>int(TimeStamp % RetentionLength)</code>.</li>
</ul>
<h3 id="configuration-file">Configuration File</h3>
<div class="sourceCode" id="cb25"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> redis://localhost:6379</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">object_time_series</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">db</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<ul>
<li>The <code>db</code> parameter of the <code>object_time_series</code>
indicates the database number for the time-series of objects. All the
Redis-TS and Redis-JSON entries in this database will be interpreted in
a specific way.</li>
</ul>
<h3 id="writer-utility">Writer Utility</h3>
<ul>
<li>For creating time-series objects as defined above, The
<code>SlowPy</code> client library can be used:</li>
<li>Example:</li>
</ul>
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os, sys, time</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> slowpy <span class="im">as</span> slp</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>redis <span class="op">=</span> slp.DataStore_Redis(host<span class="op">=</span><span class="st">&#39;localhost&#39;</span>, port<span class="op">=</span><span class="dv">6379</span>, db<span class="op">=</span><span class="dv">1</span>, retention_length<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>histogram <span class="op">=</span> slp.Histogram(<span class="st">&#39;test_histogram_01&#39;</span>, <span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> slp.Graph(<span class="st">&#39;test_graph_01&#39;</span>, [<span class="st">&#39;time&#39;</span>, <span class="st">&#39;value&#39;</span>])</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>redis.flush_db()</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>tk, xk <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        histogram.fill(np.random.normal(<span class="dv">5</span>, <span class="dv">2</span>))</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    tk <span class="op">=</span> tk <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    xk <span class="op">+=</span> np.random.normal(<span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    graph.add_point(tk, xk)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    redis.write_object_timeseries(histogram)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    redis.write_object_timeseries(graph)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span></code></pre></div>
<h2 id="time-series-of-blobs-2">Time-series of Blobs</h2>
<ul>
<li>[TODO] store blob as string value (binary-safe, up to 1GB)</li>
</ul>
<h2 id="hash-as-a-tree">Hash as a Tree</h2>
<ul>
<li>Hash values can be accessed as “current” tree objects, with a
channel name equal to the key (optionally with a suffix).</li>
</ul>
<h2 id="current-histograms-graphs-tables-trees">“Current” Histograms,
Graphs, Tables &amp; Trees</h2>
<ul>
<li>With RedisJSON, JSON representation of histograms, graphs, tables
and trees can be stored as a value of the Redis key-value store, in
either as a Redis-JSON object or as a JSON string.</li>
<li>See <a
href="DataModel.html#value-types-and-json-representation">Data Model
section</a> for the JSON structures.</li>
</ul>
<p>
<ul>
<li>As the values are not assigned to time-stamps, those are treated as
“time neutral”.</li>
<li>All the RedisJSON key-value pairs in the <code>key_value</code>
section will be automatically taken.
<p>
Example of a Python script to write a “current” histogram:</li>
</ul>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> redis</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> redis.Redis(<span class="st">&#39;localhost&#39;</span>, <span class="dv">6379</span>, <span class="dv">1</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>hist <span class="op">=</span> {</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;bins&#39;</span>: { <span class="st">&#39;min&#39;</span>: <span class="dv">0</span>, <span class="st">&#39;max&#39;</span>: <span class="dv">100</span> },</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;counts&#39;</span>: [ <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">14</span>, <span class="dv">11</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span> ]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>r.json().<span class="bu">set</span>(<span class="st">&#39;hist00&#39;</span>, <span class="st">&#39;$&#39;</span>, hist)</span></code></pre></div>
<ul>
<li>The SlowPy utility can also be used to write the JSON objects: just
replace <code>write_object_timeseries()</code> with
<code>write.object()</code>.</li>
</ul>
<h1 id="mongodb">MongoDB</h1>
<h2 id="preparation-2">Preparation</h2>
<ul>
<li>Install Python3 module “pymongo”</li>
</ul>
<h2 id="time-series-of-scalars">Time-Series of Scalars</h2>
<p>[TODO] implement schema-based binding</p>
<h2 id="time-series-of-histograms-graphs-tables-trees-3">Time-Series of
Histograms, Graphs, Tables &amp; Trees</h2>
<ul>
<li>[TODO] Just store JSON objects</li>
</ul>
<h2 id="time-series-of-blobs-3">Time-Series of Blobs</h2>
<ul>
<li>[TODO] use GridFS</li>
</ul>
<h1 id="couchdb">CouchDB</h1>
<h2 id="preparation-3">Preparation</h2>
<ul>
<li>Install Python3 module “couchdb”</li>
</ul>
<h2 id="schema">Schema</h2>
<p>Create a CouchDB view with the key being the time-stamp, e.g.:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> (doc) {</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> record <span class="op">=</span> {</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;tag&quot;</span><span class="op">:</span> doc<span class="op">.</span><span class="at">channel</span><span class="op">,</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;field01&quot;</span><span class="op">:</span> doc<span class="op">.</span><span class="at">value01</span><span class="op">,</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;field02&quot;</span><span class="op">:</span> doc<span class="op">.</span><span class="at">value02</span><span class="op">,</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">emit</span>(doc<span class="op">.</span><span class="at">timestamp</span><span class="op">,</span> record)<span class="op">;</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here the record fields can be scalars, JSON, or Blob-ID. Tags are
optional. Multiple views can be created. Currently only the UNIX
timestamp is accepted for the key.</p>
<p>The SlowDash schema description for CouchDB is similar to that of SQL
DB, except that a view is used instead of a table. As timestamps are
used for the keys of the view, the time information is not necessary in
the schema description.</p>
<pre><code>VIEW_NAME [TAG] = FIELD1, FIELD2, ...</code></pre>
<p><code>VIEW_NAME</code> is
<code>DESIGN_DOCUMENT_NAME/INDEX_NAME</code>.</p>
<p>If a view contains only data fields, and all the data fields are
taken into channels, the schema description can be a just view name.</p>
<p>Write the schema in the project configuration file:</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> couchdb://USER:PASS@localhost:5984/MyDB</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">time_series</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> MyDesignDoc/MyIndex</span></span></code></pre></div>
<p>channels are scanned from the data, but old channels that do not
appear in a last segment of data might not be found. In that case,
explicitly list the channel names:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> MyDesignDoc/MyIndex[Tag] = Field01, Field02, ...</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">tags</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">list</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="st">&#39;Tag01&#39;</span><span class="kw">,</span><span class="at"> </span><span class="st">&#39;Tag02&#39;</span><span class="kw">,</span><span class="at"> ... </span><span class="kw">]</span></span></code></pre></div>
<h2 id="time-series-of-scalars-1">Time-Series of Scalars</h2>
<h4 id="case-1-tag-values-for-channel-2">Case 1: Tag Values for
Channel</h4>
<div class="sourceCode" id="cb32"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> MyDesigDoc/MyIndex[Tag]</span></span></code></pre></div>
<h4 id="case-2-fields-for-channel-1">Case 2: Fields for Channel</h4>
<div class="sourceCode" id="cb33"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> MyDesignDoc/MyIndex = Field01, Field02,...</span></span></code></pre></div>
<h4 id="case-3-tag-and-fields-for-channel-1">Case 3: Tag and Fields for
Channel</h4>
<div class="sourceCode" id="cb34"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">time_series</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> MyDesigDoc/MyIndex[Tag] = Field01(default), Field02, ...</span></span></code></pre></div>
<h4 id="case-4-tag-flags-and-fields-for-channel-1">Case 4: Tag, Flags
and Fields for Channel</h4>
<p>Flags are currently not supported. Modify the CouchDB view definition
in a way that a tag includes flags.</p>
<h2 id="time-series-of-histograms-graphs-tables-trees-4">Time-Series of
Histograms, Graphs, Tables &amp; Trees</h2>
<p>Store JSON objects as data values:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> (doc) {</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> record <span class="op">=</span> {</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;spectrum&quot;</span><span class="op">:</span> {</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;labels&quot;</span><span class="op">:</span> [ <span class="st">&quot;Frequency (Hz)&quot;</span><span class="op">,</span> <span class="st">&quot;FFT&quot;</span> ]<span class="op">,</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;x&quot;</span><span class="op">:</span> [ <span class="op">...</span> ]<span class="op">,</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;y&quot;</span><span class="op">:</span> [ <span class="op">...</span> ]</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">emit</span>(doc<span class="op">.</span><span class="at">timestamp</span><span class="op">,</span> record)<span class="op">;</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then specify the schema in <code>object_time_series</code>:</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> couchdb://USER:PASS@localhost:5984/MyDB</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">object_time_series</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> MyDesignDoc/MyIndex</span></span></code></pre></div>
<h2 id="time-series-of-blobs-4">Time-Series of Blobs</h2>
<ul>
<li>Save a blob object (image file etc) as a CouchDB attachment.</li>
<li>Use the same structure as the time-series of objects, with the blob
data type.</li>
</ul>
<div class="sourceCode" id="cb37"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> (doc) {</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> record <span class="op">=</span> {</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;photo&quot;</span><span class="op">:</span> {</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>            <span class="dt">mime</span><span class="op">:</span> doc<span class="op">.</span><span class="at">_attachments</span>[doc<span class="op">.</span><span class="at">name</span>]<span class="op">.</span><span class="at">content_type</span><span class="op">,</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>            <span class="dt">id</span><span class="op">:</span> doc<span class="op">.</span><span class="at">_id</span> <span class="op">+</span> <span class="st">&#39;/&#39;</span> <span class="op">+</span> doc<span class="op">.</span><span class="at">name</span><span class="op">,</span> </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>            <span class="dt">meta</span><span class="op">:</span> doc<span class="op">.</span><span class="at">parameters</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">emit</span>(doc<span class="op">.</span><span class="at">timestamp</span><span class="op">,</span> record)<span class="op">;</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 id="view-rows-as-a-table">View-Rows as a Table</h2>
<p>A CouchDB view can be accessed as a table object with
<code>view_table</code>:</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> couchdb://USER:PASS@localhost:5984/MyDB</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">view_table</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> DataTable</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> MyDesignDoc/MyIndex = Field01, Field02, ..</span></span></code></pre></div>
<h2 id="view-row-as-a-tree">View-Row as a Tree</h2>
<p>A row of a CouchDB view can be accessed as a tree object with
<code>view_tree</code>:</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> couchdb://USER:PASS@localhost:5984/MyDB</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">view_tree</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> DataRecord</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> MyDesignDoc/MyIndex = Field01, Field02, ..</span></span></code></pre></div>
<h2 id="database-information-as-a-tree">Database information as a
Tree</h2>
<p>Current database information such as the file size can be obtained as
a tree data object. Just make a <code>database_info</code> entry in the
<code>data_source</code> definition with a name:</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> couchdb://USER:PASS@localhost:5984/MyDB</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">database_info</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> DBInfo</span></span></code></pre></div>
<h1 id="local-csv-files">Local CSV Files</h1>
<ul>
<li>A directory containing CSV files can be used as a data store, in a
very similar way as tables in the RDBMS (no SQL queries, though).</li>
<li>One CSV file corresponds to one table, each CSV file must have a
header line for its first line.</li>
</ul>
<h2 id="time-series-of-scalar-values-3">Time-Series of Scalar
Values</h2>
<p>To access a table containing time-series data, write the schema in
the <code>time_series</code> entry:</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> csv:///PATH/TO/DIRECTORY</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> FILE_ROOT_NAME [ TAG_COLUMN ] @ TIME_COLUMN</span></span></code></pre></div>
<h2 id="time-series-of-histograms-graphs-tables-trees-5">Time-Series of
Histograms, Graphs, Tables &amp; Trees</h2>
<ul>
<li>same as SQL databases
<ul>
<li>store JSON string as data value</li>
<li>use <code>object_time_series</code> entry</li>
</ul>
<div class="sourceCode" id="cb42"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">url</span><span class="kw">:</span><span class="at"> csv:///PATH/TO/DIRECTORY</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">object_time_series</span><span class="kw">:</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> histograms[channel]@timestamp(unix)=value</span></span></code></pre></div></li>
</ul>
<h2 id="current-histograms-graphs-tables-trees-1">“Current” Histograms,
Graphs, Tables &amp; Trees</h2>
<ul>
<li>a table without a time-stamp column stores “current” objects</li>
<li>use <code>object</code> entry</li>
</ul>
<div class="sourceCode" id="cb43"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> csv:///PATH/TO/DIRECTORY</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">object_time_series</span><span class="kw">:</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> histograms[channel]=value</span></span></code></pre></div>
<h1 id="local-yaml-files">Local YAML Files</h1>
<ul>
<li>One YAML file stores one Tree object</li>
<li>[TODO] Multiple YAML files with time-stamps encoded in the file
names</li>
<li>[TODO] implement <code>valid_from</code>.</li>
</ul>
<div class="sourceCode" id="cb44"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> YAML</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> RunConfig</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">file</span><span class="kw">:</span><span class="at"> RunConfig.yaml</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">valid_from</span><span class="kw">:</span><span class="at"> now</span></span></code></pre></div>
<h1 id="local-root-files">Local ROOT Files</h1>
<p>[TODO]</p>


</body>
</html>
