<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Project Setup</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="style.css" />
</head>

<body>

<header>
<div class="title">Project Setup</div><p>
<div class="toc">
<span class="toc-title">Contents</span>
<nav id="TOC">
<ul>
<li><a href="#setup" id="toc-setup">Setup</a>
<ul>
<li><a href="#project-directory" id="toc-project-directory">Project
Directory</a></li>
<li><a href="#project-configuration-file"
id="toc-project-configuration-file">Project Configuration File</a></li>
<li><a href="#substitutions"
id="toc-substitutions">Substitutions</a></li>
<li><a href="#styles" id="toc-styles">Styles</a></li>
<li><a href="#testing-the-configuration"
id="toc-testing-the-configuration">Testing the Configuration</a></li>
</ul></li>
<li><a href="#running-the-server" id="toc-running-the-server">Running
the Server</a>
<ul>
<li><a href="#running-in-a-docker-container"
id="toc-running-in-a-docker-container">Running in a Docker
Container</a></li>
<li><a href="#running-as-a-bare-metal-user-process"
id="toc-running-as-a-bare-metal-user-process">Running as a Bare-Metal
User Process</a></li>
<li><a href="#launching-from-apache-web-server-cgi-or-wsgi"
id="toc-launching-from-apache-web-server-cgi-or-wsgi">Launching from
Apache Web Server (CGI or WSGI)</a></li>
</ul></li>
<li><a href="#using-a-reverse-proxy-server"
id="toc-using-a-reverse-proxy-server">Using a Reverse Proxy
Server</a></li>
<li><a href="#jupyter-integration" id="toc-jupyter-integration">Jupyter
Integration</a>
<ul>
<li><a href="#bare-metal" id="toc-bare-metal">Bare-Metal</a></li>
<li><a href="#docker" id="toc-docker">Docker</a></li>
</ul></li>
<li><a href="#slowdash-watchdog-slowdog"
id="toc-slowdash-watchdog-slowdog">SlowDash Watchdog (SlowDog)</a></li>
<li><a href="#security-considerations"
id="toc-security-considerations">Security Considerations</a></li>
<li><a href="#advanced-topics" id="toc-advanced-topics">Advanced
Topics</a>
<ul>
<li><a href="#dynamic-generation-of-config-contents"
id="toc-dynamic-generation-of-config-contents">Dynamic Generation of
Config Contents</a></li>
</ul></li>
</ul>
</nav>
</div>
</header>

<h1 id="setup">Setup</h1>
<h2 id="project-directory">Project Directory</h2>
<ul>
<li><p>Every project has a dedicated project directory.</p></li>
<li><p>The configuration file is <code>SlowdashProject.yaml</code>,
placed at the project directory.</p></li>
<li><p>Project directory is specified at run time by one of the
following:</p>
<ul>
<li><code>--project-dir</code> option</li>
<li><code>SLOWDASH_PROJECT</code> environmental variable</li>
<li>current working directory</li>
</ul></li>
<li><p>Under the project directory, the <code>config</code> directory is
automatically created. The web interface posts files only to this
directory.</p></li>
</ul>
<h2 id="project-configuration-file">Project Configuration File</h2>
<p>The project configuration file describes:</p>
<ul>
<li>Name, title of the project</li>
<li>Data source type and location</li>
<li>Control tasks</li>
<li>Styles</li>
<li>Server-side user modules</li>
<li>System control parameters</li>
</ul>
<p>Example:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> ATDS</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">title</span><span class="kw">:</span><span class="at"> Atomic Tritium Demonstrator at UW (ATDS)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> PostgreSQL</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> p8_db_user:****@localhost:5432/p8_sc_db</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">time_series</span><span class="kw">:</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">schema</span><span class="kw">:</span><span class="at"> data_table[channel]@timestamp=value</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">style</span><span class="kw">:</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">theme</span><span class="kw">:</span><span class="at"> light</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">title</span><span class="kw">:</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">color</span><span class="kw">:</span><span class="at"> white</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">background</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;#4b2e83&quot;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">system</span><span class="kw">:</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">file_mode</span><span class="kw">:</span><span class="at"> </span><span class="dv">0666</span></span></code></pre></div>
<h4 id="data-source-entry-data_source-often-necessary">Data Source Entry
(<code>data_source</code>, often necessary)</h4>
<ul>
<li><code>type</code>: type of user data store. Common ones are:
<ul>
<li><code>PostgreSQL</code>, <code>MySQL</code>,
<code>SQLite</code></li>
<li><code>InfluxDB</code></li>
<li><code>Redis</code></li>
<li><code>MongoDB</code></li>
<li><code>CouchDB</code></li>
<li><code>YAML</code></li>
</ul></li>
<li>other parameters: defined by each data source. See the <a
href="DataBinding.html">Data Binding section</a> for details.</li>
</ul>
<h4 id="taskentry-task-optional">TaskEntry (<code>task</code>,
optional)</h4>
<ul>
<li>Server-side control tasks (user Python script). See the <a
href="ControlScript.html">Controls section</a> for details.</li>
</ul>
<h4 id="style-entry-style-optional">Style Entry (<code>style</code>,
optional)</h4>
<p>See <a href="#styles">Styles</a> below.</p>
<h4 id="system-entry-system-optional">System Entry (<code>system</code>,
optional)</h4>
<ul>
<li><code>file_mode</code> (default ’0644`): Access mode of
configuration files uploaded from Web clients</li>
<li><code>file_gid</code>: Group ID of configuration files uploaded from
Web clients</li>
<li><code>our_security_is_perfect</code>: set <code>true</code> to
enable Python script uploading; be extremely careful to use this</li>
</ul>
<h4
id="authenticate-entry-authenticate-for-special-purposes">Authenticate
Entry (<code>authenticate</code>, for special purposes)</h4>
<p>See <a href="#security-considerations">Security Considerations</a>
below.</p>
<h4 id="module-entry-module-optional">Module Entry (<code>module</code>,
optional)</h4>
<ul>
<li>Server-side user modules (user Python script). See the <a
href="UserModule.html">User Module section</a> for details.</li>
</ul>
<h2 id="substitutions">Substitutions</h2>
<p>Values in <code>SlowdashProject.yaml</code> can use variable and
command substitutions. The syntax is basically the same as
docker-compose:</p>
<ul>
<li><code>${VARIABLE}</code> for substitution with environmental
variable</li>
<li><code>${VARIABLE:-DEFAULT}</code> with default when the variable is
undefined or the value is empty</li>
<li><code>${VARIABLE-DEFAULT}</code> with default when the variable is
undefined</li>
<li><code>$(COMMAND)</code> for substitution with shell command
execution result</li>
<li><code>$$</code> for literal <code>$</code></li>
<li><code>environment</code> entry to define variables, either as a dict
or an array</li>
</ul>
<p>Example:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> BASE=${HOME:-/home/slow}/project</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> DB=sqlite:///${BASE}/SlowStore.db</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_source</span><span class="kw">:</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> ${DB}</span></span></code></pre></div>
<h2 id="styles">Styles</h2>
<h3 id="configuration">Configuration</h3>
<ul>
<li><code>theme</code> (default <code>light</code>): currently
<code>light</code> or <code>dark</code></li>
<li><code>title</code>:
<ul>
<li><code>color</code>: title text color (default
<code>white</code>)</li>
<li><code>background</code>: title bar background (default
<code>#4b2e83</code>)</li>
</ul></li>
<li><code>logo</code>:
<ul>
<li><code>file</code>: file name of the logo image, stored under the
project <code>config</code> directory.</li>
<li><code>position</code>: <code>left</code> or <code>right</code></li>
<li><code>background</code>: background color (default
<code>none</code>)</li>
<li><code>link</code>: URL to open when the logo is clicked</li>
</ul></li>
<li><code>panel</code>:
<ul>
<li><code>plotGridEnabled</code>, <code>plotTicksOutwards</code>:
<code>true</code> or <code>false</code></li>
<li><code>plotBackgroundColor</code>, <code>plotMarginColor</code>,
<code>plotFrameColor</code>, <code>plotLabelColor</code>,
<code>plotGridColor</code></li>
<li><code>plotFrameThickness</code>: default <code>2</code></li>
</ul></li>
<li><code>negate</code>: list of image files used in canvas, the colors
of which are to be negated (for dark mode)</li>
</ul>
<h3 id="title-bar-style-example">Title-bar Style Example</h3>
<div class="sourceCode" id="cb3"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">style</span><span class="kw">:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">title</span><span class="kw">:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">background</span><span class="kw">:</span><span class="at"> linear-gradient(125deg, rgba(75,46,131,1), rgba(75,46,131,1), rgba(75,46,131,0.9))</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">logo</span><span class="kw">:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">file</span><span class="kw">:</span><span class="at"> P8_Logo_2017.png</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">position</span><span class="kw">:</span><span class="at"> left</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">background</span><span class="kw">:</span><span class="at"> linear-gradient(90deg, rgba(255,255,255, 0.6), rgba(255,255,255, 0.4), rgba(255,255,255, 0))</span></span></code></pre></div>
<p><img src="fig/ProjectSetup-Styles-TitleBar.png" style="width:50%;margin-left:2em;border:thin solid gray"></p>
<p>The <code>background</code> property takes CSS “background” values /
expressions. See, e.g.,
<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/background" target="_blank">a
Mozilla document</a> for some examples.</p>
<p>The logo file(s) must be placed under the project’s
<code>config</code> directory.</p>
<h3 id="plot-style-examples">Plot Style Examples</h3>
<h4 id="default-style">Default Style</h4>
<p><img src="fig/ProjectSetup-Styles-Default.png" style="width:50%;margin-left:2em;border:thin solid gray"></p>
<h4 id="dark-theme">Dark Theme</h4>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">style</span><span class="kw">:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">theme</span><span class="kw">:</span><span class="at"> dark</span></span></code></pre></div>
<p><img src="fig/ProjectSetup-Styles-Dark.png" style="width:50%;margin-left:2em;border:thin solid gray"></p>
<h4 id="custom-style">Custom Style</h4>
<div class="sourceCode" id="cb5"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">style</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">panel</span><span class="kw">:</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">plotTicksOutwards</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">plotFrameThickness</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">plotBackgroundColor</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;#f0f0f0&quot;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">plotGridColor</span><span class="kw">:</span><span class="at"> gray</span></span></code></pre></div>
<p><img src="fig/ProjectSetup-Styles-2.png" style="width:50%;margin-left:2em;border:thin solid gray"></p>
<h2 id="testing-the-configuration">Testing the Configuration</h2>
<p>Running the <code>slowdash</code> command without the
<code>--port</code> option takes parameters from the arguments and
prints output to screen. Run the command at the same directory as the
configuration file is located.</p>
<h4 id="printing-the-configuration">Printing the Configuration</h4>
<div class="sourceCode" id="cb6"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ slowdash config</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    &quot;project&quot;: {</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        &quot;name&quot;: &quot;ATDS&quot;,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        &quot;title&quot;: &quot;Atomic Tritium Demonstrator at UW (ATDS)&quot;,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        &quot;error_message&quot;: &quot;&quot;</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="printing-channel-list">Printing Channel List</h4>
<div class="sourceCode" id="cb7"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ slowdash channels</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>23-03-22 12:48:34 INFO: loaded datasource module &quot;datasource_SQLAlchemy&quot;</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>[</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  {&quot;name&quot;: &quot;sccm_Alicat_Inj_Gas&quot;}, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  {&quot;name&quot;: &quot;mbar_CC10_Inj_Gas&quot;}, </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  {&quot;name&quot;: &quot;mbar_IG_Vac_MS&quot;}, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  {&quot;name&quot;: &quot;degC_RTD1_Acc_AS&quot;}, </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  {&quot;name&quot;: &quot;degC_RTD2_Acc_AS&quot;}, </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  ...</span></code></pre></div>
<h4 id="printing-data">Printing Data</h4>
<div class="sourceCode" id="cb8"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ slowdash &#39;data/sccm_Alicat_Inj_Gas?length=60&#39;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>23-03-22 12:50:20 INFO: loaded datasource module &quot;datasource_SQLAlchemy&quot;</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  &quot;sccm_Alicat_Inj_Gas&quot;: {</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    &quot;start&quot;: 1679514341, &quot;length&quot;: 60, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    &quot;t&quot;: [2.364, 12.364, 22.355, 32.366, 42.364, 52.362], </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    &quot;x&quot;: [-0.015, -0.014, -0.014, -0.015, -0.014, -0.016]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>When the argument includes a special character of the shell (such as
<code>?</code> and <code>&amp;</code>), quote the entire argument.</p>
<h1 id="running-the-server">Running the Server</h1>
<p><strong>WARNING</strong>: SlowDash is designed for internal use
within a secured network, and therefore, no security protection is
implemented. It is strongly recommended that you do not expose the
system to the public internet. External access is assumed to be done
through VPN or ssh tunnel.</p>
<h2 id="running-in-a-docker-container">Running in a Docker
Container</h2>
<p>Docker container images are available on DockerHub and GitHub
Container Registry:</p>
<ul>
<li>DockerHub (<a
href="https://hub.docker.com/r/slowproj/slowdash">https://hub.docker.com/r/slowproj/slowdash</a>):
<code>slowproj/slowdash:TAG</code></li>
<li>GitHub Package (<a
href="https://github.com/slowproj/slowdash/pkgs/container/slowdash">https://github.com/slowproj/slowdash/pkgs/container/slowdash</a>):
<code>ghcr.io/slowproj/slowdash:TAG</code></li>
</ul>
<p>Or, to build a container locally, run
<code>docker build -t slowdash</code> at the slowdash source
directory:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ git clone https://github.com/slowproj/slowdash.git --recurse-submodules</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">$ cd slowdash</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">$ docker build -t slowdash .</span></span></code></pre></div>
<p>The SlowDash container image is configured to have a project
directory at <code>/project</code> and open a port at
<code>18881</code>. Map the volume and port accordingly.</p>
<h4 id="single-container">Single Container</h4>
<div class="sourceCode" id="cb10"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ cd PATH/TO/SLOWDASH/PROJECT</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">$ docker run -p 18881:18881 -v $(pwd):/project REPO/slowdash:TAG</span></span></code></pre></div>
<h4 id="docker-compose">Docker Compose</h4>
<p>First write <code>docker-compose.yaml</code> at your project
directory.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">slowdash</span><span class="kw">:</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> REPO/slowdash:TAG</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> .:/project</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;18881:18881&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ docker compose up</span></span></code></pre></div>
<h2 id="running-as-a-bare-metal-user-process">Running as a Bare-Metal
User Process</h2>
<div class="sourceCode" id="cb13"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ slowdash --project-dir=PROJECT_DIR --port=18881</span></span></code></pre></div>
<ul>
<li><code>--project-dir</code> can be omitted if:
<ul>
<li><code>SLOWDASH_PROJECT</code> environment variable is set, or</li>
<li><code>slowdash</code> command is launched at the project directory.
<p></li>
</ul></li>
<li>The <code>slowdash</code> process must keep running while accepting
the Web requests. For this, a terminal multiplexer, such as “tumx” or
“GNU Screen” would be useful.</li>
</ul>
<h2 id="launching-from-apache-web-server-cgi-or-wsgi">Launching from
Apache Web Server (CGI or WSGI)</h2>
<p>SlowDash can be executed as a CGI or WSGI module of the Apache web
server.</p>
<h4 id="advantages">Advantages</h4>
<ul>
<li>As long as the web server is running, there will be no additional
maintenance overhead for this SlowDash project. This may be useful to
keep the data accessible after the measurement has been completed.</li>
</ul>
<h4 id="disadvantages">Disadvantages</h4>
<ul>
<li>User Python scripts (control tasks and user modules) are disabled
for CGI and WSGI by default, in order to prevent multiple executions of
user scripts in an unexpected way. To use a module with CGI/WSGI, set
the <code>enabled_for_cgi</code> parameter <code>true</code> in the
module configuration. Be careful of all the side effects, including
performance overhead and security concerns.</li>
<li>CGI starts a SlowDash process for every HTTP request (can be very
frequent!), therefore,
<ul>
<li>Severe performance overhead exists, and</li>
<li>No continuous data processing is possible, such as the one typically
done in user modules.</li>
</ul></li>
</ul>
<p>WSGI does not have these issues, but be cautious with the number of
processes that WSGI launches. If user modules are used, setting the
number of WSGI processes to one would be safe. Do not use
multi-threading in WSGI processes (set the number of threads to
one).</p>
<h3 id="prerequisite">Prerequisite</h3>
<ul>
<li>Apache2 Web Server, with cgi and userdir enabled</li>
<li>Apache module <code>mod_wsgi</code> for WSGI</li>
</ul>
<h3 id="setup-1">Setup</h3>
<p>There is a setup script in <code>slowdash/utils</code>. Run this
script at the project directory:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ cd PATH/TO/PROJECT</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">$ PATH/TO/SLOWDASH/utils/slowdash-setup-apache.py --interface=CGI   (or --interface=WSGI)</span></span></code></pre></div>
<h4 id="cgi">CGI</h4>
<p>To set up CGI, run the script with the <code>--interface=CGI</code>
option. It will install a set of files under the user’s public web
directory (typically <code>/home/USER/public_html</code>), and display
messages like:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>=== INSTALLATION IS SUCCESSFUL ===</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>- To setup SLOWDASH CGI for another project, set SLOWDASH_PROJECT and run this program.</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>- It is safe to run this slowdash-setup-cgi.py multiple times, even for the same project.</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>- CGI can be disabled by deleting the CGI directory.</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>- Disabled CGI can be re-enabled by running this program again.</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>- Web-file directory for this project: /home/sanshiro/public_html/SlowDash/MySlowSystem</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>=== Apache configuration (CGI) ===</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>- Install Apache2.</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>- Enable cgi, userdir, rewrite, and headers modules by:</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">$ sudo a2enmod cgid userdir rewrite headers</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>- Edit /etc/apache2/mods-enabled/userdir.conf to allow overriding.</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>- Restart Apache by:</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">$ sudo systemctl restart apache2</span></span></code></pre></div>
<p>CGI requires a proper setting of the Apache web server as shown in
the output above. Follow the displayed instructions (modify as needed)
if not done previously.</p>
<p>The script places an Apache user directory configuration file
(<code>.htaccess</code>) with contents like:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode apache"><code class="sourceCode apache"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>DirectoryIndex<span class="st"> slowhome.html</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>AddType<span class="st"> text/javascript .mjs</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Options</span><span class="ch"> </span><span class="kw">+ExecCGI</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>AddHandler<span class="st"> cgi-script .cgi</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="ex">RewriteEngine</span><span class="ch"> </span><span class="kw">On</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>RewriteRule<span class="st"> ^api/(.*)$ slowdash.cgi/$1</span></span></code></pre></div>
<p>For a SlowDash CGI setup in a different way, mind that it requires
URL rewriting.</p>
<h4 id="wsgi-daemon">WSGI (Daemon)</h4>
<p>To set up WSGI, run the script with the <code>--interface=WSGI</code>
option. It will install a set of files under the user’s public web
directory (typically <code>/home/USER/public_html</code>), and display
messages like:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>=== INSTALLATION IS SUCCESSFUL ===</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Public HTML directory for this project is: /home/sanshiro/public_html/SlowDash/MySlowSystem</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>- To setup a public HTML for another project, set SLOWDASH_PROJECT and run this program.</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>- It is safe to run this program multiple times, even for the same project.</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>- Public HTML can be disabled by deleting the HTML directory.</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>- Disabled public HTML can be re-enabled by running this program again.</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>=== Apache configuration (WSGI) ===</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>- Install Apache2.</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>- Install mod_wsgi by something like:</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">$ sudo apt install libapache2-mod-wsgi-py3</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">$ sudo yum install mod_wsgi</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">$ brew install mod-wsgi</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>- Enable wsgi, userdir, rewrite, and headers modules by:</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">$ sudo a2enmod wsgi userdir rewrite headers</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>- Add the following lines to /etc/apache2/apache2.conf for WSGI daemon:</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    WSGIDaemonProcess slowdash_MySlowSystem_wsgi processes=5 threads=1 home=/home/sanshiro/public_html/SlowDash/MySlowSystem</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    WSGIProcessGroup slowdash_MySlowSystem_wsgi</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    WSGIApplicationGroup %{GLOBAL}</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>- Restart Apache by:</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">$ sudo systemctl restart apache2</span></span></code></pre></div>
<p>WSGI requires a proper setting of the Apache web server as shown in
the output above. Follow the displayed instructions (modify as needed)
if not done previously.</p>
<p>The script places an Apache user directory configuration file
(<code>.htaccess</code>) with contents like:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode apache"><code class="sourceCode apache"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>DirectoryIndex<span class="st"> slowhome.html</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>AddType<span class="st"> text/javascript .mjs</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Options</span><span class="ch"> </span><span class="kw">+ExecCGI</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>AddHandler<span class="st"> wsgi-script .wsgi</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="ex">RewriteEngine</span><span class="ch"> </span><span class="kw">On</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>RewriteRule<span class="st"> ^api/(.*)$ slowdash.wsgi/$1</span></span></code></pre></div>
<p>Although a dedicated daemon is created for this SlowDash project,
currently only one WSGI can be set up on one host. The other SlowDash
project must use CGI.</p>
<h1 id="using-a-reverse-proxy-server">Using a Reverse Proxy Server</h1>
<p>Having an external Web server, such as Nginx or Apache, is often
useful for:</p>
<ul>
<li>using a standard URL string instead of a port number (i.e.,
<code>/slowdash</code> instead of <code>:18881</code>)</li>
<li>using a faster HTTP/2 protocol (SlowDash uses HTTP/1.1)</li>
<li>enabling HTTPS encryption</li>
<li>adding basic authentication</li>
</ul>
<p>When setting up a reverse proxy, be aware that</p>
<ul>
<li>SlowDash uses WebSocket at <code>/ws</code>, which often needs
dedicated routing</li>
<li>SlowDash uses “long poll”, which needs a longer timeout (typically
many days)</li>
</ul>
<p>For a setup with Docker Compose, examples can be found in the
<code>ExampleProjects/ReverseProxy</code> directory.</p>
<h3 id="nginx-setting">Nginx Setting</h3>
<p>This is the reverse proxy part of Nginx configuration, including
WebSocket and considering Long Poll.</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode xorg"><code class="sourceCode xorg"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>server {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    location /slowdash/ {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>        proxy_pass http://SLOWDASH_HOST:18881/;</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        proxy_http_version 1.1;</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        proxy_set_header Upgrade $http_upgrade;</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        proxy_set_header Connection &quot;upgrade&quot;;</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        proxy_set_header Host $host;</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        proxy_set_header X-Real-IP $remote_addr;</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        proxy_set_header X-Forwarded-Proto $scheme;</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        proxy_read_timeout 8640000s;  #<span class="co"> 1000 days for long polling used in SlowDash</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        proxy_send_timeout 8640000s;  #<span class="co"> 1000 days for long polling used in SlowDash</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        proxy_connect_timeout 10s;</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Replace <code>SLOWDASH_HOST</code> with your actual SlowDash host
name. A full working example in Docker Compose with more features such
as HTTPS, HTTP/2, and Basic Authentication can be found in
<code>ExampleProjects/ReverseProxy/Nginx</code>.</p>
<h3 id="apache-setting">Apache Setting</h3>
<p>The following Apache modules need to be enabled:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ sudo a2enmod proxy</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">$ sudo a2enmod proxy_http</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="kw">$ sudo a2enmod proxy_wstunnel</span></span></code></pre></div>
<p>This is the reverse proxy part of the Apache configuration, which
includes WebSocket and long polling.</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode apache"><code class="sourceCode apache"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">&lt;VirtualHost</span><span class="at"> *:80</span><span class="fu">&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ProxyPreserveHost</span><span class="ch"> </span><span class="kw">On</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ProxyRequests</span><span class="ch"> </span><span class="kw">Off</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># timeout 100 days, for long polling used in SlowDash</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Timeout</span><span class="ch"> </span><span class="fl">8640000</span><span class="ch">        </span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="ch">    ProxyTimeout </span><span class="fl">8640000</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="ch">    </span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    ProxyPass<span class="st"> /slowdash/ http://SLOWDASH_HOST:18881/</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    ProxyPassReverse<span class="st"> /slowdash/ http://SLOWDASH_HOST:18881/</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for WebSockets</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    ProxyPass<span class="st"> /slowdash/ws/ ws://SLOWDASH_HOST:18881/ws/</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    ProxyPassReverse<span class="st"> /slowdash/ws/ ws://SLOWDASH_HOST:18881/ws/</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">&lt;Location</span><span class="at"> /slowdash/ws/</span><span class="fu">&gt;</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>        ProxyPass<span class="st"> ws://SLOWDASH_HOST:18881/ws/</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        <span class="ex">ProxyPreserveHost</span><span class="ch"> </span><span class="kw">On</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        RequestHeader<span class="st"> set Upgrade &quot;websocket&quot;</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        RequestHeader<span class="st"> set Connection &quot;upgrade&quot;</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">&lt;/Location&gt;</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="fu">&lt;/VirtualHost&gt;</span></span></code></pre></div>
<p>Replace <code>SLOWDASH_HOST</code> with your actual SlowDash host
name. A full working example in Docker Compose with more features such
as HTTPS, HTTP/2, and Basic Authentication can be found in
<code>ExampleProjects/ReverseProxy/Apahce</code>.</p>
<h1 id="jupyter-integration">Jupyter Integration</h1>
<p>By providing Jupyter URL and token in
<code>SlowdashProject.yaml</code>, SlowDash can export the displayed
data to Jupyter Notebook so that users can continue analysis on Jupyter.
Two examples, with and without a reverse proxy, can be found in
<code>ExampleProject/Jupyter</code>.</p>
<h2 id="bare-metal">Bare-Metal</h2>
<div class="sourceCode" id="cb22"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Jupyter Test</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">title</span><span class="kw">:</span><span class="at"> Jupyter Integration</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">export</span><span class="kw">:</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> jupyter</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">url</span><span class="kw">:</span><span class="at"> http://localhost:8888</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">token</span><span class="kw">:</span><span class="at"> YOUR_VERY_SECRET_JUPYTER_TOKEN</span><span class="co">     # consider passing this through an environmental variable</span></span></code></pre></div>
<h2 id="docker">Docker</h2>
<p>A Docker image that includes both the SlowPy library and the Jupyter
server is available on DockerHub and GitHub CR. You can also build the
image locally by <code>make docker</code>.</p>
<p>Include this image in the <code>docker-compose.yaml</code>, by adding
environmental variables about the Jupyter settings to the SlowDash
container:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">notebook</span><span class="kw">:</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> slowproj/slowpy-notebook</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">command</span><span class="kw">:</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> start-notebook.sh</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> --NotebookApp.token=YOUR_VERY_SECRET_JUPYTER_TOKEN</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> 8888:8888</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./notebook:/home/jovyan</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">slowdash</span><span class="kw">:</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> slowproj/slowdash</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> .:/project</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;18881:18881&quot;</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> JUPYTER_URL=http://localhost:8888</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> JUPYTER_TOKEN=YOUR_VERY_SECRET_JUPYTER_TOKEN</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> JUPYTER_INTERNAL_URL=http://notebook:8888</span><span class="co">      # Jupyter seen from SlowDash</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> SLOWDASH_INTERNAL_URL=http://slowdash:18881</span><span class="co">    # SlowDash seen from Jypyter</span></span></code></pre></div>
<p>Note that the Jupyter and SlowDash URLs are different when accessed
within the container system.</p>
<p>Edit the <code>SlowdashProject.yaml</code> file to include the
Jupyter settings:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">export</span><span class="kw">:</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> jupyter</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">url</span><span class="kw">:</span><span class="at"> ${JUPYTER_URL}</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">token</span><span class="kw">:</span><span class="at"> ${JUPYTER_TOKEN}</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">jupyter_internal_url</span><span class="kw">:</span><span class="at"> ${JUPYTER_INTERNAL_URL}</span><span class="co">      # Jupyter seen from SlowDash</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">slowdash_internal_url</span><span class="kw">:</span><span class="at"> ${SLOWDASH_INTERNAL_URL}</span><span class="co">    # SlowDash seen from Jypyter</span></span></code></pre></div>
<h1 id="slowdash-watchdog-slowdog">SlowDash Watchdog (SlowDog)</h1>
<p>SlowDog sends HTTP requests to the SlowDash server periodically, and
if it does not receive a reply before the timeout, the dog kills the
server and restarts another one.</p>
<p>To enable SlowDog, add <code>--slowdog</code> option:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ slowdash --port=18881 --slowdog</span></span></code></pre></div>
<p>SlowDog is enabled in the SlowDash Docker container.</p>
<h1 id="security-considerations">Security Considerations</h1>
<p>As already mentioned, <b>SlowDash is designed for internal use
only</b> within a secured network, and therefore, no security protection
is implemented. It is strongly recommended that you do not expose the
system to the public internet. External access is assumed to be done
<b>through VPN or ssh tunnel</b>.</p>
<h3 id="basic-authentication">Basic Authentication</h3>
<p>In a case where you cannot trust your internal friends, SlowDash
implements the “Basic Authentication”. Combine this authentication
<b>with HTTPS using a reverse proxy</b> to encrypt the password and
communication. There are examples in the `ExampleProjects/ReverseProxy’
directory.</p>
<p>To use Basic Authentication, first install the <code>bcrypt</code>
Python package if it is not yet installed:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ pip3 install bcrypt</span></span></code></pre></div>
<p>Then generate an authentication key using the
<code>slowdash-generate-key.py</code> script in
<code>slowdash/utils</code>:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ python3 PATH/TO/SLOWDASH/utils/slowdash-generate-key.py slow dash</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    &quot;authentication&quot;: {</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        &quot;type&quot;: &quot;Basic&quot;,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        &quot;key&quot;: &quot;slow:$2a$12$UWLc20NG5E3drX35cfA/5eFxuDVC0U79dGg4UP/mo55cj222/vuRS&quot;</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here, the first argument is the user name and the second is the
password.</p>
<p>Add the key in the project configuration file under the
<code>authentication</code> entry:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slowdash_project</span><span class="kw">:</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">authentication</span><span class="kw">:</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Basic</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">key</span><span class="kw">:</span><span class="at"> slow:$2a$12$UWLc20NG5E3drX35cfA/5eFxuDVC0U79dGg4UP/mo55cj222/vuRS</span></span></code></pre></div>
<p>This key can also be used for Apache, but some Apache keys,
especially old ones such as MD5 keys, which are still widely used, can
not be used for SlowDash.</p>
<h4 id="only-for-the-cgiwsgi-mode">Only for the CGI/WSGI mode</h4>
<p>Rerun the <code>slowdash-setup-apache.py</code> command to update the
Web Server configuration.</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ PATH/TO/SLOWDASH/utils/slowdash-setup-apache.py --interface=CGI   (or --interface=WSGI)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>Project: MySlowSystem</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>Project directory: /home/sanshiro/MySlowSystem/SlowdashProject</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>Web-file directory: /home/sanshiro/public_html/SlowDash/MySlowSystem</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>User: slow</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>continue? [Y/n] y</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>...</span></code></pre></div>
<p>Note that a new line, <code>User: slow</code>, has been added.</p>
<h3 id="built-in-https-server-asgi-only">Built-in HTTPS server (ASGI
only)</h3>
<p>If SlowDash runs in ASGI mode, a built-in HTTPS mode is available. To
use this feature, provide the SSL/TLS key and certification files to the
<code>slowdash</code> command:</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode console"><code class="sourceCode highlightconsole"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ slowdash  --port=18881  --ssl-keyfile=KEY_FILE  --ssl-certfile=CERT_FILE</span></span></code></pre></div>
<p>This feature might be dropped in future SlowDash releases. Using a
reverse proxy server is recommended for long-term setups.</p>
<h1 id="advanced-topics">Advanced Topics</h1>
<h2 id="dynamic-generation-of-config-contents">Dynamic Generation of
Config Contents</h2>
<p>Configuration of SlowDash contents (dashboard, plot layout, etc.) is
described in JSON/YAML files in the project <code>config</code>
directory, with a name like <code>slowplot-XXX.json</code>. These static
JSON/YAML (or any files with a name like <code>TYPE-XXX.EXT</code>
placed in <code>config</code>) can be replaced with a Python script that
generates the contents dynamically. To do so, put a Python script with a
name like <code>slowplot-XXX.py</code> instead of
<code>slowplot-XXX.json</code>, and define an
<code>async _setup(app)</code> function that returns the config content.
The <code>app</code> parameter here is the SlowDash App object, with
which you can access SlowDash resources such as the channel list.</p>
<p>This is an example of dynamically generating a slowplot page that
shows all the time-series channels. This example can be found in
<code>ExampleProjects/Advanced/DynamicLayout</code>.</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> _setup(app):</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    channels <span class="op">=</span> <span class="cf">await</span> app.request_channels()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    logging.debug(<span class="ss">f&#39;Channels: </span><span class="sc">{</span>channels<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    layout <span class="op">=</span> {</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;panels&quot;</span>: [{</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;type&quot;</span>: <span class="st">&quot;timeaxis&quot;</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;plots&quot;</span>: [{ <span class="st">&quot;type&quot;</span>: <span class="st">&quot;timeseries&quot;</span>, <span class="st">&quot;channel&quot;</span>: ch[<span class="st">&#39;name&#39;</span>] }]</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">for</span> ch <span class="kw">in</span> channels <span class="cf">if</span> ch.get(<span class="st">&#39;type&#39;</span>, <span class="st">&#39;numeric&#39;</span>) <span class="op">==</span> <span class="st">&#39;numeric&#39;</span> ]</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> layout</span></code></pre></div>
<p>Most functions of the SlowDash App are <code>async</code>, therefore
these must be called with <code>await</code> in an <code>async</code>
function, as done in the example above.</p>


</body>
</html>
